<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>For Pookie ‚ù§Ô∏è</title>
  <link
    href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,600;1,400&family=Nunito:wght@400;600&display=swap"
    rel="stylesheet"
  />
  <style>
    *, *::before, *::after {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: 'Nunito', sans-serif;
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      background: #fdf2f8;
      overflow: hidden;
      position: relative;
    }

    body::before {
      content: '';
      position: fixed;
      inset: 0;
      background:
        radial-gradient(ellipse 80% 50% at 20% 80%, rgba(244, 114, 182, 0.12) 0%, transparent 70%),
        radial-gradient(ellipse 60% 40% at 80% 20%, rgba(236, 72, 153, 0.08) 0%, transparent 70%),
        radial-gradient(ellipse 50% 60% at 50% 50%, rgba(251, 191, 216, 0.06) 0%, transparent 70%);
      pointer-events: none;
      z-index: 0;
    }

    /* === CARD === */
    .card {
      position: relative;
      z-index: 1;
      text-align: center;
      padding: clamp(38px, 6vmin, 68px) clamp(30px, 5vmin, 56px) clamp(46px, 7vmin, 76px);
      width: min(580px, 88vw);
      background: rgba(255, 255, 255, 0.7);
      backdrop-filter: blur(12px);
      border-radius: clamp(26px, 3.5vmin, 38px);
      border: 1px solid rgba(244, 114, 182, 0.25);
      box-shadow:
        0 8px 40px rgba(236, 72, 153, 0.1),
        0 2px 8px rgba(0,0,0,0.04);
      animation: cardIn 0.6s cubic-bezier(0.34, 1.56, 0.64, 1) both;
    }

    @keyframes cardIn {
      from { opacity: 0; transform: translateY(24px) scale(0.96); }
      to   { opacity: 1; transform: translateY(0) scale(1); }
    }

    @keyframes fadeSlideIn {
      from { opacity: 0; transform: translateY(10px); }
      to   { opacity: 1; transform: translateY(0); }
    }

    /* === SCREENS === */
    .screen {
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      position: relative;
      z-index: 1;
    }
    .screen.hide { display: none; }

    /* === FLOATING HEARTS === */
    .heart {
      position: fixed;
      opacity: 0;
      pointer-events: none;
      z-index: 0;
      animation: floatHeart linear infinite;
    }

    @keyframes floatHeart {
      0%   { transform: translateY(100vh) rotate(0deg); opacity: 0; }
      10%  { opacity: 0.6; }
      90%  { opacity: 0.6; }
      100% { transform: translateY(-120px) rotate(360deg); opacity: 0; }
    }

    /* === SHARED BUTTONS === */
    .btn {
      font-family: 'Nunito', sans-serif;
      font-weight: 600;
      border: none;
      border-radius: 50px;
      cursor: pointer;
      transition: transform 0.25s cubic-bezier(0.34, 1.56, 0.64, 1),
                  box-shadow 0.2s ease,
                  font-size 0.3s ease,
                  padding 0.3s ease,
                  width 0.3s ease;
      outline: none;
      position: relative;
    }

    /* === GATE SCREEN === */
    .lock-icon {
      font-size: clamp(2.4rem, 5vw, 3.4rem);
      margin-bottom: clamp(16px, 2.8vmin, 28px);
      animation: fadeSlideIn 0.4s 0.1s ease both;
    }

    .gate-instruction {
      font-family: 'Playfair Display', serif;
      font-size: clamp(1.05rem, 2.1vw, 1.3rem);
      color: #9d174d;
      line-height: 1.65;
      margin-bottom: clamp(5px, 1vmin, 10px);
      animation: fadeSlideIn 0.4s 0.2s ease both;
    }

    .gate-sub {
      font-size: clamp(0.88rem, 1.7vw, 1.08rem);
      color: #be185d;
      margin-bottom: clamp(22px, 3.8vmin, 38px);
      animation: fadeSlideIn 0.4s 0.3s ease both;
    }

    .btn-go {
      background: linear-gradient(135deg, #ec4899, #db2777);
      color: #fff;
      padding: clamp(13px, 2.2vmin, 20px) clamp(42px, 7vmin, 64px);
      font-size: clamp(1.1rem, 2.1vw, 1.35rem);
      box-shadow: 0 4px 18px rgba(236, 72, 153, 0.35);
      animation: fadeSlideIn 0.4s 0.4s ease both;
    }

    .btn-go:hover {
      transform: translateY(-2px) scale(1.05);
      box-shadow: 0 6px 24px rgba(236, 72, 153, 0.45);
    }
    .btn-go:active { transform: scale(0.96); }

    /* === CHALLENGE SCREEN === */
    .progress-ring-wrap {
      position: relative;
      width: clamp(130px, 20vmin, 180px);
      height: clamp(130px, 20vmin, 180px);
      margin: 0 auto clamp(16px, 2.8vmin, 28px);
    }

    .progress-ring {
      width: 100%;
      height: 100%;
      transform: rotate(-90deg);
    }

    .progress-ring-bg {
      fill: none;
      stroke: rgba(236, 72, 153, 0.12);
      stroke-width: 10;
    }

    .progress-ring-fill {
      fill: none;
      stroke: #ec4899;
      stroke-width: 10;
      stroke-linecap: round;
      stroke-dasharray: 364.42;
      stroke-dashoffset: 364.42;
      transition: stroke-dashoffset 0.12s ease;
    }

    .progress-text {
      position: absolute;
      inset: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column;
      gap: 3px;
    }

    .progress-count {
      font-size: clamp(2.2rem, 4.2vw, 3.2rem);
      font-weight: 700;
      color: #be185d;
      line-height: 1;
    }

    .progress-slash {
      font-size: clamp(0.82rem, 1.5vw, 1rem);
      color: #9d174d;
      opacity: 0.6;
    }

    .timer-wrap {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin-bottom: clamp(16px, 2.8vmin, 28px);
    }

    .timer-number {
      font-family: 'Playfair Display', serif;
      font-size: clamp(1.8rem, 3.4vw, 2.6rem);
      font-weight: 600;
      color: #be185d;
      transition: color 0.3s ease;
    }

    .timer-wrap.urgent .timer-number {
      color: #e11d48;
      animation: pulse 0.5s ease infinite alternate;
    }

    @keyframes pulse {
      from { transform: scale(1); }
      to   { transform: scale(1.18); }
    }

    .timer-label {
      font-size: clamp(0.7rem, 1.3vw, 0.85rem);
      color: #9d174d;
      opacity: 0.55;
      text-transform: uppercase;
      letter-spacing: 0.06em;
      margin-top: 3px;
    }

    .challenge-hint {
      font-size: clamp(0.85rem, 1.6vw, 1rem);
      color: #9d174d;
      font-style: italic;
      margin-bottom: clamp(14px, 2.4vmin, 24px);
    }

    .btn-tap {
      background: rgba(236, 72, 153, 0.08);
      color: #9d174d;
      padding: clamp(9px, 1.6vmin, 14px) clamp(20px, 3.5vmin, 30px);
      font-size: clamp(0.78rem, 1.4vw, 0.9rem);
      border: 1px solid rgba(236, 72, 153, 0.22);
      box-shadow: none;
    }
    .btn-tap:hover { background: rgba(236, 72, 153, 0.15); }
    .btn-tap:active { transform: scale(0.94); }

    /* === WIN SCREEN === */
    .win-icon {
      font-size: clamp(2.6rem, 5.5vw, 3.8rem);
      margin-bottom: clamp(14px, 2.4vmin, 24px);
      animation: fadeSlideIn 0.4s 0.1s ease both;
    }

    .win-text {
      font-family: 'Playfair Display', serif;
      font-size: clamp(1.5rem, 3.2vw, 2rem);
      font-weight: 600;
      color: #be185d;
      margin-bottom: clamp(6px, 1.2vmin, 12px);
      animation: fadeSlideIn 0.4s 0.2s ease both;
    }

    .win-sub {
      font-size: clamp(0.92rem, 1.8vw, 1.12rem);
      color: #9d174d;
      margin-bottom: clamp(24px, 4vmin, 40px);
      animation: fadeSlideIn 0.4s 0.3s ease both;
    }

    .btn-next {
      background: linear-gradient(135deg, #ec4899, #db2777);
      color: #fff;
      padding: clamp(14px, 2.4vmin, 22px) clamp(48px, 8vmin, 72px);
      font-size: clamp(1.15rem, 2.3vw, 1.4rem);
      box-shadow: 0 4px 18px rgba(236, 72, 153, 0.35);
      animation: fadeSlideIn 0.4s 0.4s ease both;
    }

    .btn-next:hover {
      transform: translateY(-2px) scale(1.05);
      box-shadow: 0 6px 24px rgba(236, 72, 153, 0.45);
    }
    .btn-next:active { transform: scale(0.96); }

    /* === FAIL SCREEN === */
    .fail-icon {
      font-size: clamp(2.4rem, 5vw, 3.4rem);
      margin-bottom: clamp(12px, 2.2vmin, 22px);
    }

    .fail-text {
      font-family: 'Playfair Display', serif;
      font-size: clamp(1.3rem, 2.8vw, 1.7rem);
      color: #9d174d;
      margin-bottom: clamp(20px, 3.5vmin, 34px);
    }

    /* === VALENTINE SCREEN === */
    .greeting {
      font-family: 'Playfair Display', serif;
      font-size: clamp(2rem, 4.8vw, 3rem);
      font-weight: 600;
      color: #be185d;
      margin-bottom: clamp(6px, 1.2vmin, 14px);
      animation: fadeSlideIn 0.5s 0.2s ease both;
    }

    .question {
      font-family: 'Playfair Display', serif;
      font-style: italic;
      font-size: clamp(1.15rem, 2.4vw, 1.6rem);
      color: #9d174d;
      margin-bottom: clamp(20px, 3.5vmin, 34px);
      animation: fadeSlideIn 0.5s 0.35s ease both;
    }

    .gif-container {
      width: clamp(190px, 32vmin, 270px);
      height: clamp(190px, 32vmin, 270px);
      margin: 0 auto clamp(22px, 3.5vmin, 36px);
      border-radius: clamp(20px, 3vmin, 30px);
      overflow: hidden;
      border: 3px solid rgba(244, 114, 182, 0.3);
      background: #fce4ec;
      animation: fadeSlideIn 0.5s 0.15s ease both;
      transition: transform 0.3s ease;
    }

    .gif-container:hover { transform: scale(1.03); }

    .gif-container img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .buttons {
      display: flex;
      gap: clamp(12px, 2.2vmin, 20px);
      justify-content: center;
      flex-wrap: wrap;
      animation: fadeSlideIn 0.5s 0.5s ease both;
    }

    .btn-yes {
      background: linear-gradient(135deg, #ec4899, #db2777);
      color: #fff;
      font-size: clamp(1rem, 1.9vw, 1.2rem);
      padding: clamp(13px, 2.2vmin, 20px) clamp(32px, 5.5vmin, 48px);
      box-shadow: 0 4px 18px rgba(236, 72, 153, 0.35);
    }

    .btn-yes:hover {
      transform: translateY(-2px) scale(1.04);
      box-shadow: 0 6px 24px rgba(236, 72, 153, 0.45);
    }
    .btn-yes:active { transform: scale(0.97); }

    .btn-no {
      background: #fff;
      color: #9d174d;
      font-size: clamp(1rem, 1.9vw, 1.2rem);
      padding: clamp(13px, 2.2vmin, 20px) clamp(32px, 5.5vmin, 48px);
      border: 2px solid rgba(236, 72, 153, 0.35);
      box-shadow: 0 2px 8px rgba(0,0,0,0.06);
      user-select: none;
      -webkit-user-select: none;
    }

    /* === CELEBRATION === */
    .main-content {
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .main-content.hide { display: none; }

    .celebration {
      display: none;
      flex-direction: column;
      align-items: center;
      gap: clamp(16px, 2.8vmin, 26px);
      animation: fadeSlideIn 0.5s ease both;
    }
    .celebration.show { display: flex; }

    .celebration-text {
      font-family: 'Playfair Display', serif;
      font-size: clamp(1.7rem, 3.8vw, 2.4rem);
      font-weight: 600;
      color: #be185d;
      text-align: center;
      line-height: 1.3;
    }

    .celebration-sub {
      font-size: clamp(0.95rem, 1.8vw, 1.15rem);
      color: #9d174d;
      font-style: italic;
    }

    .celebration .gif-container {
      width: clamp(210px, 35vmin, 290px);
      height: clamp(210px, 35vmin, 290px);
    }

    /* === VALENTINE CARD: 16:9 FULL VIEWPORT === */
    #valentineCard {
      width: min(96vw, calc(96vh * 16 / 9));
      aspect-ratio: 16 / 9;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: clamp(24px, 3vmin, 40px);
    }

    #valentineCard .main-content {
      width: 100%;
    }

    #valentineCard .celebration {
      width: 100%;
      max-width: 480px;
    }
  </style>
</head>
<body>

  <!-- Floating hearts -->
  <div class="heart" style="left:5%;  animation-duration:8s;  animation-delay:0s;   font-size:clamp(0.7rem,1.2vw,1rem);">üíó</div>
  <div class="heart" style="left:15%; animation-duration:11s; animation-delay:2s;   font-size:clamp(0.5rem,0.9vw,0.7rem);">‚ô•Ô∏è</div>
  <div class="heart" style="left:30%; animation-duration:9s;  animation-delay:4s;   font-size:clamp(0.75rem,1.3vw,1.1rem);">üíó</div>
  <div class="heart" style="left:50%; animation-duration:12s; animation-delay:1s;   font-size:clamp(0.55rem,1vw,0.8rem);">‚ô•Ô∏è</div>
  <div class="heart" style="left:70%; animation-duration:10s; animation-delay:3s;   font-size:clamp(0.7rem,1.2vw,1rem);">üíó</div>
  <div class="heart" style="left:85%; animation-duration:8s;  animation-delay:5s;   font-size:clamp(0.5rem,0.9vw,0.7rem);">‚ô•Ô∏è</div>
  <div class="heart" style="left:92%; animation-duration:11s; animation-delay:0.5s; font-size:clamp(0.6rem,1.1vw,0.9rem);">üíó</div>

  <!-- GATE SCREEN -->
  <div id="gateScreen" class="screen">
    <div class="card">
      <div class="lock-icon">üîí</div>
      <div class="gif-container">
        <img src="https://media1.giphy.com/media/80nq4Wc3sl5JadtaEr/giphy.gif" alt="Curious GIF" />
      </div>
      <p class="gate-instruction">In order to see the message, you must press the Space bar 70 times within 15 seconds.</p>
      <p class="gate-sub">When ready, press GO.</p>
      <button class="btn btn-go" onclick="startChallenge()">GO</button>
    </div>
  </div>

  <!-- CHALLENGE SCREEN -->
  <div id="challengeScreen" class="screen hide">
    <div class="card">
      <div class="progress-ring-wrap">
        <svg class="progress-ring" viewBox="0 0 140 140">
          <circle class="progress-ring-bg" cx="70" cy="70" r="58"></circle>
          <circle class="progress-ring-fill" id="progressRing" cx="70" cy="70" r="58"></circle>
        </svg>
        <div class="progress-text">
          <span class="progress-count" id="pressCount">0</span>
          <span class="progress-slash">/70</span>
        </div>
      </div>
      <div class="timer-wrap" id="timerWrap">
        <span class="timer-number" id="timerText">15.0</span>
        <span class="timer-label">seconds left</span>
      </div>
      <p class="challenge-hint">Keep pressing Space!</p>
      <button class="btn btn-tap" id="tapBtn">Tap here (mobile)</button>
    </div>
  </div>

  <!-- WIN SCREEN -->
  <div id="winScreen" class="screen hide">
    <div class="card">
      <div class="win-icon">üéâ</div>
      <p class="win-text">Good job!</p>
      <p class="win-sub">Click Next to see the message</p>
      <button class="btn btn-next" onclick="showScreen('valentineScreen')">Next</button>
    </div>
  </div>

  <!-- FAIL SCREEN -->
  <div id="failScreen" class="screen hide">
    <div class="card">
      <div class="fail-icon">üò¢</div>
      <p class="fail-text">Please try again</p>
      <button class="btn btn-go" onclick="startChallenge()">GO Again</button>
    </div>
  </div>

  <!-- VALENTINE SCREEN -->
  <div id="valentineScreen" class="screen hide">
    <div class="card" id="valentineCard">
      <div class="main-content" id="mainContent">
        <div class="greeting">Hey Pookie ‚ù§Ô∏è</div>
        <div class="question">Will you be my Valentine?</div>
        <div class="gif-container">
          <img src="https://media2.giphy.com/media/IVK6xNBpEAHYyOdghk/giphy.gif" alt="Valentine question GIF" />
        </div>
        <div class="buttons">
          <button class="btn btn-yes" id="yesBtn" onclick="onYes()">Yes</button>
          <button class="btn btn-no" id="noBtn">No</button>
        </div>
      </div>
      <div class="celebration" id="celebration">
        <div class="celebration-text">Yay! üéâ</div>
        <div class="celebration-sub">I knew you'd say yes.</div>
        <div class="gif-container">
          <img src="https://media3.giphy.com/media/hA0bU8VRyg84lAfSes/giphy.gif" alt="Pudgy Penguins celebrating" />
        </div>
      </div>
    </div>
  </div>

  <!-- Confetti -->
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

  <script>
    // =====================
    // GATE / CHALLENGE LOGIC
    // =====================
    const TARGET        = 70;
    const TIME_LIMIT    = 15;
    const CIRCUMFERENCE = 2 * Math.PI * 58;

    let spaceCount    = 0;
    let timerInterval = null;
    let isActive      = false;

    function showScreen(id) {
      document.querySelectorAll('.screen').forEach(s => s.classList.add('hide'));
      document.getElementById(id).classList.remove('hide');
    }

    function startChallenge() {
      if (timerInterval) {
        clearInterval(timerInterval);
        document.removeEventListener('keydown', onSpace);
      }

      spaceCount = 0;
      isActive   = true;
      document.getElementById('pressCount').textContent = '0';
      document.getElementById('timerText').textContent  = '15.0';
      document.getElementById('progressRing').style.strokeDashoffset = CIRCUMFERENCE;
      document.getElementById('timerWrap').classList.remove('urgent');

      showScreen('challengeScreen');

      const startTime = Date.now();
      timerInterval = setInterval(() => {
        const elapsed  = (Date.now() - startTime) / 1000;
        const timeLeft = TIME_LIMIT - elapsed;

        if (timeLeft <= 0) {
          clearInterval(timerInterval);
          timerInterval = null;
          isActive = false;
          document.removeEventListener('keydown', onSpace);
          document.getElementById('timerText').textContent = '0.0';
          showScreen('failScreen');
          return;
        }

        document.getElementById('timerText').textContent = timeLeft.toFixed(1);
        if (timeLeft <= 5) document.getElementById('timerWrap').classList.add('urgent');
      }, 100);

      document.addEventListener('keydown', onSpace);
    }

    function onSpace(e) {
      if (e.code !== 'Space') return;
      e.preventDefault();
      registerPress();
    }

    function registerPress() {
      if (!isActive || spaceCount >= TARGET) return;

      spaceCount++;
      document.getElementById('pressCount').textContent = spaceCount;

      const progress = spaceCount / TARGET;
      document.getElementById('progressRing').style.strokeDashoffset = CIRCUMFERENCE * (1 - progress);

      if (spaceCount >= TARGET) {
        clearInterval(timerInterval);
        timerInterval = null;
        isActive = false;
        document.removeEventListener('keydown', onSpace);
        showScreen('winScreen');
      }
    }

    document.getElementById('tapBtn').addEventListener('touchstart', (e) => {
      e.preventDefault();
      registerPress();
    });
    document.getElementById('tapBtn').addEventListener('click', registerPress);

    // =====================
    // VALENTINE LOGIC
    // =====================
    const noBtn   = document.getElementById('noBtn');
    const yesBtn  = document.getElementById('yesBtn');
    const valCard = document.getElementById('valentineCard');
    let noX = 0, noY = 0;
    let wasNear  = false;
    let attempts = 0;

    let maxReached = false;

    function growYes() {
      if (maxReached) return;

      attempts++;
      const scale    = Math.pow(1.25, attempts);
      const fontSize = (1.2 * scale).toFixed(2);
      const padV     = Math.round(20 * scale);
      const padH     = Math.round(48 * scale);
      yesBtn.style.fontSize = fontSize + 'rem';
      yesBtn.style.padding  = padV + 'px ' + padH + 'px';

      // Next frame: check if button has reached 80% of card width
      requestAnimationFrame(() => {
        const cardWidth = valCard.getBoundingClientRect().width;
        const maxWidth  = cardWidth * 0.8;
        if (yesBtn.getBoundingClientRect().width >= maxWidth) {
          yesBtn.style.width = maxWidth + 'px';
          maxReached = true;
        }
      });
    }

    document.addEventListener('mousemove', (e) => {
      if (document.getElementById('valentineScreen').classList.contains('hide')) return;
      if (document.getElementById('mainContent').classList.contains('hide')) return;

      const rect = noBtn.getBoundingClientRect();
      const cx   = rect.left + rect.width  / 2;
      const cy   = rect.top  + rect.height / 2;
      const dx   = e.clientX - cx;
      const dy   = e.clientY - cy;
      const dist = Math.hypot(dx, dy);

      if (dist < 90) {
        if (!wasNear) {
          wasNear = true;
          growYes();
        }
        noBtn.style.transition = 'transform 0.15s cubic-bezier(0.2, 0.8, 0.3, 1)';
        const angle = Math.atan2(dy, dx);
        const push  = 150;
        noX -= Math.cos(angle) * push;
        noY -= Math.sin(angle) * push;
        noX = Math.max(-240, Math.min(240, noX));
        noY = Math.max(-190, Math.min(190, noY));
        noBtn.style.transform = `translate(${noX}px, ${noY}px)`;
      } else {
        wasNear = false;
      }
    });

    valCard.addEventListener('mouseleave', () => {
      noX = 0; noY = 0; wasNear = false;
      noBtn.style.transition = 'transform 0.5s cubic-bezier(0.34, 1.56, 0.64, 1)';
      noBtn.style.transform  = 'translate(0, 0)';
    });

    noBtn.addEventListener('touchstart', (e) => {
      e.preventDefault();
      growYes();
      noBtn.style.transition = 'transform 0.15s cubic-bezier(0.2, 0.8, 0.3, 1)';
      noX = (Math.random() - 0.5) * 340;
      noY = (Math.random() - 0.5) * 260;
      noX = Math.max(-240, Math.min(240, noX));
      noY = Math.max(-190, Math.min(190, noY));
      noBtn.style.transform = `translate(${noX}px, ${noY}px)`;
    });

    function onYes() {
      document.getElementById('mainContent').classList.add('hide');
      document.getElementById('celebration').classList.add('show');

      confetti({
        particleCount: 120,
        spread: 70,
        startVelocity: 40,
        colors: ['#ec4899', '#db2777', '#f472b6', '#fda4af', '#fff', '#fbbf24'],
        ticks: 300
      });

      setTimeout(() => {
        confetti({ particleCount: 60, angle: 60,  spread: 55, origin: { x: 0 }, colors: ['#ec4899', '#db2777', '#f472b6', '#fda4af'] });
        confetti({ particleCount: 60, angle: 120, spread: 55, origin: { x: 1 }, colors: ['#ec4899', '#db2777', '#f472b6', '#fda4af'] });
      }, 400);
    }

    showScreen('gateScreen');
  </script>
</body>
</html>
